import{h as f,u,y as g,_ as U,a as c,b as e,t as d,q as i,e as p,f as b,n as m,F as I,k as M,o as w}from"./index-BMMDxlvw.js";import{A as v}from"./AddUserForm-FmUcFlON.js";const k={components:{AddUserForm:v},data(){return{showForm:!1,isEditMode:!1,newUser:{name:"",username:"",password:"",confirmPassword:"",email:"",profileImageUrl:"",userId:-1},passwordError:"",user:{name:"",username:"",password:"",confirmPassword:"",email:"",profileImageUrl:"",userId:-1},showDeleteModal:!1}},methods:{showModal(){this.showForm=!0},showPasswordModel(){this.isEditMode=!0,this.showForm=!0},closeModal(){this.showForm=!1,this.isEditMode=!1,this.passwordError=""},openDeleteModal(l){this.selectedUser=l,this.showDeleteModal=!0},closeDeleteModal(){this.selectedUser=null,this.showDeleteModal=!1},async deleteAUser(l){const s=localStorage.getItem("jwtToken")||"";if(this.newUser.userId!=localStorage.getItem("loggedInUserId")){this.passwordError="You are not authorized to edit this account.";return}if(!s){this.passwordError="You are not authorized to edit this account.";return}await f(l,s),localStorage.removeItem("loggedInUserId"),localStorage.removeItem("jwtToken"),this.$router.push("/").then(()=>window.location.reload())},async saveUserEdits(){if(this.newUser.userId!=localStorage.getItem("loggedInUserId")){this.passwordError="You are not authorized to edit this account.";return}const l=localStorage.getItem("jwtToken")||"";if(!l){this.passwordError="You are not authorized to edit this account.";return}if(this.isEditMode)if(this.newUser.password!==this.newUser.confirmPassword){this.passwordError="Passwords do not match.";return}else delete this.newUser.confirmPassword,await u(this.newUser.userId,this.newUser,l),this.closeModal(),window.location.reload();else delete this.newUser.confirmPassword,delete this.newUser.password,console.log(this.newUser),await u(this.newUser.userId,this.newUser,l),this.closeModal(),window.location.reload()},updateUser(l){this.newUser=l}},async mounted(){const l=localStorage.getItem("jwtToken")||"";l||(console.log("No token found"),this.$router.push("/"));const s=localStorage.getItem("loggedInUserId")||null;if(s){const n=await g(parseInt(s),l);if(n.isSuccess){const a=n.data;delete a.password,this.newUser={...a},this.user={...a}}else console.error("Failed to fetch user data.")}}},_={class:"profile"},E={class:"top"},y={class:"title is-2"},D={class:"box"},C={class:"columns is-vcentered"},P={class:"column is-narrow"},S={class:"image is-64x64"},F=["src"],A={class:"column"},B=["href"],x={class:"main-buttons"},N={class:"modal-card"},z={class:"modal-card-head"},T={class:"modal-card-title title is-3",style:{color:"#00d1b2","margin-bottom":"0!important"}},Y={class:"modal-card-body"},j={key:0,class:"help is-danger"},V={class:"modal-card-foot"},q={class:"buttons"},L={class:"modal-card"},R={class:"modal-card-head"},W={class:"modal-card-body",id:"deleteUserModelBody"},G={class:"buttons"};function H(l,s,n,a,r,o){const h=M("add-user-form");return w(),c(I,null,[e("div",_,[e("div",E,[e("h1",y,"Welcome, "+d(r.user.name),1)]),e("div",D,[e("div",C,[e("div",P,[e("figure",S,[e("img",{src:r.user.profileImageUrl,alt:"Profile Image"},null,8,F)])]),e("div",A,[e("p",null,[s[10]||(s[10]=e("strong",null,"Name:",-1)),i(" "+d(r.user.name),1)]),e("p",null,[s[11]||(s[11]=e("strong",null,"Username:",-1)),i(" "+d(r.user.username),1)]),e("p",null,[s[12]||(s[12]=e("strong",null,"Email:",-1)),i(" "+d(r.user.email),1)]),e("p",null,[s[13]||(s[13]=e("strong",null,"Profile Image URL: ",-1)),e("a",{href:r.user.profileImageUrl,target:"_blank"},d(r.user.profileImageUrl),9,B)])])])]),e("div",x,[e("button",{onClick:s[0]||(s[0]=(...t)=>o.showModal&&o.showModal(...t)),class:"button is-primary",id:"formBtn1"},"Edit Profile"),e("button",{onClick:s[1]||(s[1]=(...t)=>o.showPasswordModel&&o.showPasswordModel(...t)),class:"button is-primary",id:"formBtn2"},"Change Password"),e("button",{onClick:s[2]||(s[2]=t=>o.openDeleteModal(r.user)),class:"button is-danger"},"Delete Account")])]),e("div",{class:m(["modal",{"is-active":r.showForm}])},[s[14]||(s[14]=e("div",{class:"modal-background"},null,-1)),e("div",N,[e("header",z,[e("p",T,d(r.isEditMode?"Change Password":"Edit Your Profile")+":",1),e("button",{class:"delete","aria-label":"close",onClick:s[3]||(s[3]=(...t)=>o.closeModal&&o.closeModal(...t))})]),e("section",Y,[r.passwordError?(w(),c("p",j,d(r.passwordError),1)):p("",!0),b(h,{newUser:r.newUser,"show-password-fields":r.isEditMode,onAddUser:o.updateUser},null,8,["newUser","show-password-fields","onAddUser"])]),e("footer",V,[e("div",q,[e("button",{class:"button is-primary",onClick:s[4]||(s[4]=t=>o.saveUserEdits())},"Submit")])])])],2),e("div",{class:m(["modal",{"is-active":r.showDeleteModal}])},[e("div",{class:"modal-background",onClick:s[5]||(s[5]=(...t)=>o.closeDeleteModal&&o.closeDeleteModal(...t))}),e("div",L,[e("header",R,[s[15]||(s[15]=e("p",{class:"modal-card-title title is-3",style:{color:"#00d1b2","margin-bottom":"0!important"}},"Delete User?",-1)),e("button",{class:"delete","aria-label":"close",onClick:s[6]||(s[6]=(...t)=>o.closeDeleteModal&&o.closeDeleteModal(...t))})]),e("section",W,[s[16]||(s[16]=e("div",null,"Are you sure you want to delete your account?",-1)),e("div",G,[e("button",{class:"button is-danger",onClick:s[7]||(s[7]=t=>o.deleteAUser(l.selectedUser.userId))},"Confirm"),e("button",{class:"button",onClick:s[8]||(s[8]=(...t)=>o.closeDeleteModal&&o.closeDeleteModal(...t))},"Cancel")])])]),e("button",{class:"modal-close is-large","aria-label":"close",onClick:s[9]||(s[9]=(...t)=>o.closeDeleteModal&&o.closeDeleteModal(...t))})],2)],64)}const O=U(k,[["render",H],["__scopeId","data-v-c1b3d411"]]);export{O as default};
